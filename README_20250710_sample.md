# NijoApplicationBuilder

**スキーマ駆動型アプリケーション生成フレームワーク**

XMLベースのスキーマ定義からアプリケーションコードの一部を自動生成し、高品質なフルスクラッチ開発を支援するフレームワークです。

---

## 📚 Tutorials（チュートリアル）
*学習指向 - NijoApplicationBuilderを段階的に学ぶ*

### はじめての方へ：5分で作る住所録アプリ

#### ステップ1：環境セットアップ
```cmd
# 新しいプロジェクトを作成
cd <プロジェクトフォルダ>
nijo.exe new
```

#### ステップ2：基本的なスキーマを定義
`nijo.xml` を編集して、住所録のデータ構造を定義します：

```xml
<?xml version="1.0" encoding="utf-8"?>
<nijo version="1.0">
  <DataModel name="Contact" displayName="連絡先">
    <Member name="Name" displayName="氏名" type="SingleLineText" required="true" />
    <Member name="Email" displayName="メールアドレス" type="SingleLineText" />
    <Member name="Phone" displayName="電話番号" type="SingleLineText" />
    <Member name="Address" displayName="住所" type="MultiLineText" />
  </DataModel>
</nijo>
```

#### ステップ3：コードを生成
```cmd
nijo.exe generate
```

#### ステップ4：アプリケーションを実行
生成されたコードをビルドして実行し、動作するアプリケーションを確認します。

### 次のステップ
- [詳細なチュートリアル：在庫管理システムの構築](./docs/tutorials/inventory-system.md)
- [中級編：カスタムバリデーションの追加](./docs/tutorials/custom-validation.md)

---

## 🛠️ How-to Guides（ハウツーガイド）
*問題解決指向 - 特定のタスクを達成する方法*

### プロジェクト管理

#### 新しいプロジェクトを始める
```cmd
cd <新しいアプリケーションのフォルダ>
nijo.exe new
```

#### 既存プロジェクトでコードを再生成する
```cmd
cd <nijo.xmlがあるフォルダ>
nijo.exe generate
```

### スキーマ定義

#### 複数テーブル間のリレーションシップを定義する
```xml
<DataModel name="Customer" displayName="顧客">
  <!-- 顧客のフィールド定義 -->
</DataModel>

<DataModel name="Order" displayName="注文">
  <Member name="Customer" type="DataModelRef" ref="Customer" required="true" />
  <!-- その他のフィールド -->
</DataModel>
```

#### カスタムバリデーションを追加する
1. `Core/OverridedApplicationService.cs` を編集
2. バリデーションロジックを実装
3. エラーメッセージを設定

#### 既存のデータベースを別のDBMSに変更する
1. `appsettings.json` の接続文字列を変更
2. 適切なEntity Framework Coreプロバイダーを追加
3. マイグレーションを実行

### 開発・デバッグ

#### 生成されたコードをデバッグする
- `__AutoGenerated` フォルダは直接編集せず、`Core/` プロジェクトで拡張

#### TypeScriptコンパイルエラーを解決する
```cmd
# TypeScriptコンパイルを実行
tsc.bat
```

---

## 📖 Reference（リファレンス）
*情報指向 - 技術仕様と詳細情報*

### プロジェクト構造
```
nijo-project/
├── Nijo/                          # コード生成エンジン
│   ├── Models/                    # モデル定義
│   ├── SchemaParsing/            # XMLパース処理
│   ├── ValueMemberTypes/         # データ型定義
│   └── Parts/                    # 技術基盤モジュール
├── Nijo.ApplicationTemplate.Ver1/ # アプリケーションテンプレート
│   ├── Core/                     # ビジネスロジック
│   ├── Core.AutoGenerated/       # 自動生成されたコア
│   ├── WebApi/                   # REST API
│   └── react/                    # フロントエンド
└── Nijo.IntegrationTest/         # 統合テスト
```

### コマンドライン API

#### nijo.exe new
新しいプロジェクトを作成します。

**構文:** `nijo.exe new [オプション]`

**生成されるファイル:**
- `nijo.xml` - サンプルスキーマ定義
- アプリケーションテンプレート一式

#### nijo.exe generate
スキーマ定義からソースコードを生成します。

**構文:** `nijo.exe generate [オプション]`

**処理内容:**
1. `nijo.xml` の妥当性検証
2. `__AutoGenerated` フォルダへのコード生成
3. 既存の自動生成ファイルの置換

### スキーマ定義リファレンス

#### DataModel
永続化されるデータを定義します。

```xml
<DataModel name="ModelName" displayName="表示名">
  <Member name="field1" type="SingleLineText" required="true" />
  <Member name="field2" type="Integer" />
</DataModel>
```

**属性:**
- `name`: モデルの内部名（必須）
- `displayName`: UI表示用の名前（必須）

#### QueryModel
検索・表示用のデータを定義します。

```xml
<QueryModel name="SearchName" displayName="検索名">
  <!-- 検索条件とデータソースの定義 -->
</QueryModel>
```

#### CommandModel
操作・コマンドを定義します。

```xml
<CommandModel name="ActionName" displayName="操作名">
  <!-- パラメータと実行ロジックの定義 -->
</CommandModel>
```

### データ型一覧

| 型名             | 説明           | C#型       | TypeScript型 |
| ---------------- | -------------- | ---------- | ------------ |
| `SingleLineText` | 単行テキスト   | `string`   | `string`     |
| `MultiLineText`  | 複数行テキスト | `string`   | `string`     |
| `Integer`        | 整数           | `int`      | `number`     |
| `Decimal`        | 小数点数       | `decimal`  | `number`     |
| `Boolean`        | 真偽値         | `bool`     | `boolean`    |
| `Date`           | 日付           | `DateTime` | `Date`       |
| `DateTime`       | 日付時刻       | `DateTime` | `Date`       |

### 技術スタック

#### サポートされている技術
- **バックエンド**: ASP.NET Core, Entity Framework Core
- **フロントエンド**: React.js, TypeScript
- **データベース**: Entity Framework Core対応のすべてのDBMS
- **開発環境**: .NET 8.0以上, Node.js

#### 生成されるコンポーネント
- RDBMSテーブル定義
- C#エンティティクラス
- TypeScript型定義
- CRUD操作API
- React UIコンポーネント
- バリデーション処理

---

## 💡 Explanation（説明）
*理解指向 - 概念と設計思想*

### なぜNijoApplicationBuilderが必要なのか？

#### 現代アプリケーション開発の課題
現代のソフトウェア開発では、単一のアプリケーションでも複数の技術スタックを組み合わせることが一般的です：

- **データベース層**: RDBMSのテーブル定義
- **バックエンド層**: Web APIのエンドポイント、ビジネスロジック
- **フロントエンド層**: UI コンポーネント、状態管理

例えば、「氏名・住所・郵便番号・電話番号」という構造のデータを管理する住所録アプリケーションを作る場合、これらの4項目は以下の場所で同じ構造として定義される必要があります：

1. データベースのテーブル定義
2. バックエンドのエンティティクラス
3. フロントエンドの型定義
4. API のリクエスト・レスポンス定義

#### 従来の開発方法の問題点
- **重複した定義**: 同じデータ構造を複数の場所で定義
- **同期コスト**: 構造変更時に複数箇所の手動修正が必要
- **整合性リスク**: 手動修正漏れによるバグの発生
- **保守コスト**: データ構造の変更が開発チーム全体に影響

### スキーマ駆動開発のアプローチ

#### 単一真実の源（Single Source of Truth）
NijoApplicationBuilderでは、**XMLスキーマ定義を唯一の真実の源**として、以下を自動生成します：

- データベーステーブル定義
- C#エンティティクラス
- TypeScript型定義
- CRUD操作処理
- バリデーション処理
- 検索・フィルタリング機能

#### 開発フローの変化

**従来の開発フロー:**
```
要件定義 → DB設計 → API設計 → UI設計 → 実装 → テスト
          ↓        ↓        ↓
        手動同期  手動同期  手動同期
```

**Nijoを使った開発フロー:**
```
要件定義 → スキーマ定義 → 自動生成 → カスタマイズ → テスト
                      ↓
                  全レイヤー同期
```

### アーキテクチャの設計思想

#### レイヤー分離
```
┌─────────────────────────────────────┐
│ Presentation Layer (React)          │  ← 自動生成 + カスタマイズ
├─────────────────────────────────────┤
│ Application Layer (Web API)         │  ← 自動生成 + カスタマイズ
├─────────────────────────────────────┤
│ Domain Layer (Core Logic)           │  ← 自動生成 + カスタマイズ
├─────────────────────────────────────┤
│ Infrastructure Layer (Database)     │  ← 自動生成
└─────────────────────────────────────┘
```

#### コード生成の哲学
- **完全自動化より拡張性**: 100%自動生成ではなく、カスタマイズ可能な基盤を提供
- **設定より規約**: 一般的なパターンはデフォルトで提供し、必要時のみカスタマイズ
- **段階的採用**: 既存プロジェクトへの部分的な導入も可能

### 適用場面とメリット

#### 最適な適用場面
- **データ中心アプリケーション**: CRM、ERP、管理システム
- **プロトタイプ開発**: 迅速な概念実証
- **中小規模チーム**: 開発リソースの効率化
- **標準化要求**: 企業内の開発標準統一

#### 主なメリット
1. **開発速度向上**: 基盤部分の自動生成により実装時間を短縮
2. **品質向上**: 手動作業削減による人的エラーの減少
3. **保守性向上**: スキーマ変更時の影響範囲を局所化
4. **学習コスト削減**: 一度覚えれば複数プロジェクトで再利用可能

#### 制約事項
- **Entity Framework Core対応DBMS**: データベースの選択肢に制約
- **特定技術スタック**: .NET + TypeScript + React環境が前提
- **複雑なドメインロジック**: 高度なビジネスルールは手動実装が必要

### カスタマイズ戦略

#### テンプレートの柔軟性
標準のアプリケーションテンプレートは以下の変更が可能です：

- **データベース**: SQLite → PostgreSQL, SQL Server等
- **認証方式**: 独自認証システムとの統合
- **UI フレームワーク**: React以外のフロントエンド技術
- **API 設計**: RESTful以外の通信方式
- **ビジネスルール**: 複雑なドメインロジックの追加

#### 拡張ポイント
```
Core/                           # ビジネスロジック拡張
├── OverridedApplicationService.cs   # サービス層のカスタマイズ
└── OverridedApplicationConfigure.cs # アプリケーション設定
```

---

## 🚀 Getting Started

どこから始めればよいかわからない場合は：

1. **初心者**: [📚 チュートリアル](#-tutorials)から「はじめての方へ」を実行
2. **既存プロジェクト改善**: [🛠️ ハウツーガイド](#-how-to-guides)で具体的な課題を解決
3. **技術詳細**: [📖 リファレンス](#-reference)で仕様を確認
4. **設計思想理解**: [💡 説明](#-explanation)でフレームワークの背景を学習

---

## 📂 主要ドキュメント

- [Nijo コード生成エンジン](./Nijo/README.md)
- [アプリケーションテンプレート](./Nijo.ApplicationTemplate.Ver1/README.md)
- [統合テスト](./Nijo.IntegrationTest/README.md)
- [貢献ガイド](./Nijo/CONTRIBUTING.md)

## ⚖️ ライセンス

このプロジェクトは[LICENSE.txt](./LICENSE.txt)の条件の下で提供されています。

---

*このドキュメントは[Diátaxis framework](https://diataxis.fr/)に基づいて構造化されています。*
